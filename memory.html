<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <title>Świąteczne Memory</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: Arial, sans-serif;
      background: radial-gradient(ellipse at center, #b60000 0%, #750000 100%);
      color: #ffffff;
      padding: 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: padding-top 0.3s ease;
    }

    body.fullscreen-active {
      padding-top: 120px;
    }

    #game-title {
      text-align: center;
      font-size: 64px;
      margin-bottom: 20px;
      font-weight: bold;
      letter-spacing: 4px;
      text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.5);
    }

    .config-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 40px;
      margin-bottom: 20px;
      font-size: 0.9rem;
      transform: scale(0.94);
    }

    .left-block, .right-block {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
    }

    .team-input {
      width: 240px;
      text-align: center;
    }

    .team-input label {
      font-size: 20px;
      display: block;
      margin-bottom: 4px;
    }

    .team-input input {
      width: 100%;
      padding: 8px;
      font-size: 16px;
      border-radius: 8px;
      border: none;
      outline: none;
    }

    .section-title {
      font-size: 20px;
      margin: 24px 0 10px;
      text-align: center;
    }

    .button-group {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 12px;
    }

    .button-group button {
      width: 150px;
      height: 44px;
      font-size: 15px;
      font-weight: bold;
      cursor: pointer;
      background-color: #104f9c;
      color: white;
      border: 4px solid white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      text-transform: none;
      transition: background-color 0.3s ease;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .button-group button.active {
      background-color: #2e7d32 !important;
    }

    #config-buttons {
      display: flex;
      gap: 20px;
      margin-top: 30px;
      margin-bottom: 30px;
    }

    #nextBtn, #configFullscreenBtn {
      width: 240px;
      height: 52px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      background-color: #104f9c;
      color: white;
      border: 4px solid white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      text-transform: capitalize;
    }

    #game-container {
      display: none;
      justify-content: center;
      align-items: flex-start;
      gap: 40px;
      flex-wrap: wrap;
    }

    .scoreboard {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      font-size: 28px;
      font-weight: bold;
      margin-top: 30px;
      margin-bottom: 10px;
      width: 240px;
    }

    .scoreboard div {
      margin: 10px 0;
    }

    #full-grid {
      display: grid;
      grid-template-columns: repeat(8, auto);
      grid-template-rows: repeat(7, auto);
      gap: 20px;
    }

    .card {
      width: clamp(40px, 8vw, 80px);
      aspect-ratio: 1 / 1;
      position: relative;
      cursor: pointer;
      border-radius: 5px;
      overflow: hidden;
    }

    .card .front {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 5px;
      display: none;
      transition: opacity 0.3s ease;
    }

    .card .cover {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 5px;
      transition: opacity 0.5s ease;
      z-index: 1;
      display: block;
      filter: grayscale(100%) brightness(0.8);
    }

    .cover.kolorowa {
      filter: none !important;
    }

    .card.flipped .front {
      display: block !important;
    }

    .card.flipped .cover {
      display: none !important;
    }

    .card.matched .front {
      opacity: 0.6;
    }

    #buttons {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 30px;
    }

    #buttons button {
      width: 250px;
      padding: 12px 20px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      background-color: #104f9c;
      color: white;
      border: 4px solid white;
      border-radius: 12px;
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.2);
      margin-bottom: 10px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    #buttons button:hover {
      transform: translateY(-3px);
      box-shadow: 0 16px 28px rgba(0, 0, 0, 0.3);
    }

    #buttons button:active {
      transform: translateY(0);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
    }

    #startBtn {
      background-color: #2e7d32 !important;
    }

    #buttons img {
      width: 150px;
      height: auto;
      display: block;
      margin-top: 10px;
    }

    #logo {
      width: 150px;
      height: auto;
    }

    #website-link {
      color: white;
      font-size: 14px;
      margin-top: 12px;
      text-align: center;
    }

    .team-name {
      font-size: 28px;
      font-weight: bold;
      color: white;
      width: 240px;
      height: 40px;
      line-height: 40px;
      padding: 0 10px;
      text-align: left;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      border-radius: 5px;
    }

    .team-name.active {
      background-color: #104f9c;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }

    .time-label {
      font-size: 12px;
      color: white;
      text-align: left;
      margin-bottom: 5px;
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .time-display {
      width: 140px;
      height: 30px;
      line-height: 30px;
      padding: 0 10px;
      font-size: 14px;
      font-weight: bold;
      text-align: center;
      background-color: #333;
      color: #fff;
      border: 2px solid #fff;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .current-team-display {
      display: none;
      font-size: 16px;
      margin-bottom: 10px;
    }

    @media (max-width: 767px) {
      .config-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        transform: none;
        width: 100%;
        max-width: 340px;
      }

      .left-block, .right-block {
        width: 100%;
        max-width: 340px;
        align-items: center;
      }

      .team-input {
        font-size: 14px;
        width: 100%;
        max-width: 340px;
      }

      .team-input input {
        font-size: 14px;
      }

      .button-group {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        width: 100%;
        max-width: 340px;
        justify-items: center;
      }

      .button-group button {
        width: 100%;
        max-width: 150px;
        font-size: 14px;
        height: 40px;
      }

      #config-buttons {
        width: 100%;
        max-width: 340px;
        flex-direction: column;
        gap: 10px;
      }

      #nextBtn, #configFullscreenBtn {
        width: 100%;
        max-width: 340px;
        font-size: 16px;
        height: 28px;
      }

      #game-title {
        font-size: 48px;
        margin-bottom: 12px;
      }

      .scoreboard {
        font-size: 24px;
        width: 100%;
        max-width: 320px;
      }

      .team-name {
        font-size: 24px;
        height: 36px;
        line-height: 36px;
        width: 100%;
        max-width: 320px;
      }

      .time-label {
        font-size: 11px;
      }

      .time-display {
        width: 120px;
        height: 28px;
        font-size: 12px;
      }

      .card {
        width: clamp(40px, 6vw, 60px);
      }
      #buttons button {
        width: 100%;
        max-width: 320px;
        font-size: 16px;
        padding: 10px;
      }
    }
  </style>
</head>
<body>
  <h1 id="memory-title">Memory Match</h1>

  <div id="config-screen">
    <div class="config-container">
      <div class="left-block">
        <div class="team-input">
          <label for="team1">Team 1 Name</label>
          <input type="text" id="team1Name" maxlength="15" placeholder="Enter team name" />
        </div>

        <div class="team-input">
          <label for="team2">Team 2 Name</label>
          <input type="text" id="team2Name" maxlength="15" placeholder="Enter team name" />
        </div>
      </div>

      <div class="right-block">
        <div class="section-title">Which team starts?</div>
        <div class="team-buttons" id="team-buttons">
          <button id="btnTeam1">Team 1</button>
          <button id="btnTeam2">Team 2</button>
        </div>
      </div>

<div class="section-title">Move Time Limit:</div>
    <div class="time-buttons" id="moveTimeButtons">
      <button data-time="15">15 min</button>
      <button data-time="30">30 min</button>
      <button data-time="60">60 min</button>
      <button data-time="0">Unlimited</button>
    </div>

    <div class="section-title">Game Duration:</div>
      <div class="time-buttons" id="gameTimeButtons">
        <button data-time="10">10 Min</button>
        <button data-time="15">15 Min</button>
        <button data-time="30">30 Min</button>
        <button data-time="0">Unlimited</button>
      </div>

    <div id="config-buttons">
      <button id="configFullscreenBtn">Fullscreen</button>
      <button id="nextBtn">Next</button>
    </div>

    <img src="img/logo.png" alt="Logo" id="logoImage" />
    <span id="website">www.example.com</span>
  </div>

  <div id="game-screen" style="display: none;">
    <div id="game-grid"></div>

    <div class="scoreboard-container">
      <div class="scoreboard">
        <div id="team1-score" class="team-name"><span id="team1-name"></span>: <span id="score1">0</span></div>
        <div id="team2-score" class="team-name"><span id="team2-name"></span>: <span id="score2">0</span></div>
        <div id="current-team"></div>
        <div class="time-label">
          Move Time: <span id="moveTimeDisplay" class="time-display">Unlimited</span>
        </div>
        <div class="time-label">
          Game Time: <span id="gameTimeDisplay" class="time-display">Unlimited</span>
        </div>
      </div>

      <div id="game-controls">
        <button id="startBtn">Start</button>
        <button id="gameFullscreenBtn">Fullscreen</button>
        <button id="returnBtn">Back</button>
        <img src="img/logo.png" alt="Logo" />
        <span id="website">www.example.com</span>
      </div>
    </div>
  </div>

  <script>
    const configScreenContainer = document.getElementById('config-screen-container');
    const team1NameInput = document.getElementById('team1Name');
    const team2NameInput = document.getElementById('team2Name');
    const btnTeam1Btn = document.getElementById('btnTeam1');
    const btnTeam2Btn = document.getElementById('btnTeam2');
    const moveTimeButtons = document.getElementById('moveTimeButtons');
    const timeButtons = document.getElementById('timeButtons');
    const nextBtnBtn = document.getElementById('nextBtnBtn');
    const configFullscreenBtn = document.getElementById('configFullscreenBtn');

    const gameScreenContainer = document.getElementById('game-screen');
    const gameGrid = document.getElementById('game-grid');
    const startGameBtn = document.getElementById('btnStart');
    const score1Display = document.getElementById('score1');
    const score2Display = document.getElementById('score2');
    const gameFullscreenBtn = document.getElementById('btn-gameFullscreen');
    const moveTimeDisplay = document.getElementById('move-time-display');
    const gameTimeDisplay = document.getElementById('game-time-display');
    const currentTeamDisplay = document.getElementById('current-team-name');
    const team1ScoreDisplay = document.getElementById('team1-score-display');
    const team2ScoreDisplay = document.getElementById('team2-score-display');
    const team1NameDisplay = document.getElementById('team1-name-display');
    const team2NameDisplay = document.getElementById('team2-name-display');
    const backBtn = document.getElementById('btn-back');

    let team1Name = '';
    let team2Name = '';
    let startingTeam = null;
    let moveTimeLimit = null;
    let gameTimeLimit = null;

    let firstCardSelected = null;
    let secondCardSelected = null;
    let boardLocked = true;
    let matchedPairsCount = 0;
    let moveTimerInterval;
    let gameTimerInterval;
    let moveSecondsCount = 0;
    let gameSecondsCount = 0;
    let gameStarted = false;
    let points1Count = 0;
    let points2Count = 0;
    let currentTeam = null;
    let cardsArray = [];

    function updateButtonLabels() {
      btnTeam1.textContent = team1NameInput.value.trim() || 'Team 1';
      btnTeam2.textContent = team2NameInput.value.trim() || 'Team 2';
    }

    function activateSingleButton(buttonGroup, value, setCallback) {
      Array.from(buttonGroup.children).forEach(btn => {
        btn.classList.toggle('active', btn.dataset.time === value);
      });
      setCallback(value);
    }

    team1NameInput.addEventListener('input', updateButtonLabels);
    team2NameInput.addEventListener('input', updateButtonLabels);

    btnTeam1.addEventListener('click', () => {
      startingTeam = true;
      btnTeam1.classList.add('active');
      btnTeam2.classList.remove('active');
    });

    btnTeam2.addEventListener('click', () => {
      startingTeam = false;
      btnTeam2.classList.add('active');
      btnTeam1.classList.remove('active');
    });

    moveTimeButtons.addEventListener('click', e => {
      if (e.target.tagName === 'BUTTON') {
        activateSingleButton(moveTimeButtons, e.target.dataset.time, val => moveTime = parseInt(val));
      }
    });

    timeButtons.addEventListener('click', e => {
      if (e.target.tagName === 'BUTTON') {
        activateSingleButton(timeButtons, e.target.dataset.time, val => gameTime = parseInt(val));
      }
    });

    function formatTime(seconds) {
      if (isNaN(seconds) || seconds < 0) {
        console.error('Invalid time value:', seconds);
        return '00:00';
      }
      const minutes = Math.floor(seconds / 60).toString().padStart(2, '0');
      const secs = Math.floor(seconds % 60).toString().padStart(2, '0');
      return `${minutes}:${secs}`;
    }

    function updateTeamHighlight() {
      team1ScoreDisplay.classList.remove('active');
      team2ScoreDisplay.classList.remove('active');
      if (currentTeam === true) {
        team1ScoreDisplay.classList.add('active');
      } else if (currentTeam === false) {
        team2ScoreDisplay.classList.add('active');
      }
    }

    function createBoard(colorCovers = false) {
      try {
        gameGrid.innerHTML = '';
        cardsArray = [];

        const totalPairs = 25;
        const cards = [];
        for (let i = 1; i <= totalPairs; i++) {
          cards.push(i, i);
        }

        const shuffledCards = cards.sort(() => Math.random() - 0.5);

        const columnLabels = ['', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'];
        const rowLabels = ['', '1', '2', '3', '4', '5', '6', '7'];

        for (let row = 0; row < 8; row++) {
          for (let col = 0; col < 9; col++) {
            const cell = document.createElement('div");
            cell.className = 'grid-cell';

            if (row === 0 && col > 0) {
              cell.classList.add('label-cell', 'hide-label');
              cell.textContent = columnLabels[col];
            } else if (col === 0 && row > 0) {
              cell.classList.add('label-cell', 'hide-label');
              cell.textContent = rowLabels[row];
            } else if (row > 0 && col > 0) {
              if (!shuffledCards.length) {
                console.error('Not enough shuffled cards');
                return;
              }
              const cardValue = shuffledCards.pop();
              const card = document.createElement('div");
              card.className = 'card';

              const frontImage = document.createElement('img');
              frontImage.src = `img/card-${cardValue}.png`;
              frontImage.className = 'front';

              const backImage = document.createElement('img');
              backImage.src = 'img/card-back.png';
              backImage.className = 'cover';
              if (colorCovers) backImage.classList.add('kolorowa');

              card.appendChild(frontImage);
              card.appendChild(backImage);
              card.addEventListener('click', () => handleCardClick(card, cardValue));
              cell.appendChild(card);
              cardsArray.push(card);
            }

            gameGrid.appendChild(cell);
          }
        }
      } catch (error) {
        console.error('Error creating board:', error);
      }
    }

    function handleCardClick(card, value) {
      if (boardLocked || card.classList.contains('flipped') || card.classList.contains('matched')) return;

      card.classList.add('flipped');

      if (!firstCardSelected) {
        firstCardSelected = { card, value };
        if (moveTimeLimit > 0) {
          moveSecondsCount = moveTimeLimit;
          moveTimeDisplay.textContent = formatTime(moveSecondsCount);
          startMoveTimer();
        }
      } else {
        secondCardSelected = { card, value };
        boardLocked = true;

        if (firstCardSelected.value === secondCardSelected.value) {
          firstCardSelected.card.classList.add('matched');
          secondCardSelected.card.classList.add('matched');

          matchedPairsCount++;
          if (currentTeam === true) {
            points1Count++;
            score1Display.textContent = points1Count;
          } else {
            points2Count++;
            score2Display.textContent = points2Count;
          }
          updateCurrentTeamDisplay();

          clearInterval(moveTimerInterval);
          if (moveTimeLimit > 0) {
            moveSecondsCount = moveTimeLimit;
            moveTimeDisplay.textContent = formatTime(moveSecondsCount);
            startMoveTimer();
          } else {
            moveTimeDisplay.textContent = 'Unlimited';
          }
          resetTurn();
        } else {
          clearInterval(moveTimerInterval);
          setTimeout(() => {
            firstCardSelected.card.classList.remove('flipped');
            secondCardSelected.card.classList.remove('flipped');
            resetTurn();
            currentTeam = !currentTeam;
            updateTeamHighlight();
            updateCurrentTeamDisplay();
            if (moveTimeLimit > 0) {
              moveSecondsCount = moveTimeLimit;
              moveTimeDisplay.textContent = formatTime(moveSecondsCount);
              startMoveTimer();
            } else {
              moveTimeDisplay.textContent = 'Unlimited';
            }
          }, 1000);
        }
      }
    }

    function resetTurn() {
      firstCardSelected = null;
      secondCardSelected = null;
      boardLocked = false;
    }

    function startMoveTimer() {
      clearInterval(moveTimerInterval);
      if (moveTimeLimit > 0) {
        moveTimerInterval = setInterval(() => {
          moveSecondsCount--;
          moveTimeDisplay.textContent = formatTime(moveSecondsCount);
          if (moveSecondsCount <= 0) {
            clearInterval(moveTimerInterval);
            if (firstCardSelected && !secondCardSelected) {
              firstCardSelected.card.classList.remove('flipped');
              resetTurn();
              currentTeam = !currentTeam;
              updateTeamHighlight();
              updateCurrentTeamDisplay();
              moveSecondsCount = moveTimeLimit;
              moveTimeDisplay.textContent = formatTime(moveSecondsCount);
              startMoveTimer();
            } else if (!firstCardSelected && !secondCardSelected) {
              currentTeam = !currentTeam;
              updateTeamHighlight();
              updateCurrentTeamDisplay();
              moveSecondsCount = moveTimeLimit;
              moveTimeDisplay.textContent = formatTime(moveSecondsCount);
              startMoveTimer();
            }
          }
        }, 1000);
      }
    }

    function startGameTimer() {
      clearInterval(gameTimerInterval);
      if (gameTimeLimit > 0) {
        gameTimerInterval = setInterval(() => {
          gameSecondsCount--;
          gameTimeDisplay.textContent = formatTime(gameSecondsCount);
          if (gameSecondsCount <= 0) {
            clearInterval(gameTimerInterval);
            boardLocked = true;
            alert('Game time is up!');
          }
        }, 1000);
      }
    }

    function restartAndStart() {
      clearInterval(moveTimerInterval);
      clearInterval(gameTimerInterval);
      moveSecondsCount = moveTimeLimit;
      gameSecondsCount = gameTimeLimit * 60;
      moveTimeDisplay.textContent = moveTimeLimit === 0 ? 'Unlimited' : formatTime(moveSecondsCount);
      gameTimeDisplay.textContent = gameTimeLimit === 0 ? 'Unlimited' : formatTime(gameSecondsCount);
      matchedPairsCount = 0;
      firstCardSelected = null;
      secondCardSelected = null;
      boardLocked = true;
      points1Count = 0;
      points2Count = 0;
      currentTeam = startingTeam === null ? true : startingTeam;
      score1Display.textContent = 0;
      score2Display.textContent = 0;
      updateTeamHighlight();
      updateCurrentTeamDisplay();

      const labelCells = document.querySelectorAll('.label-cell');
      labelCells.forEach(el => el.classList.add('hide-label'));

      const cards = document.querySelectorAll('.card');
      if (cards.length === 0) {
        console.warn('No cards found for animation');
        createBoard(true);
        boardLocked = false;
        if (gameStarted) {
          startMoveTimer();
          startGameTimer();
        }
        return;
      }

      const gridRect = gameGrid.getBoundingClientRect();
      const centerX = gridRect.left + gridRect.width / 2;
      const centerY = gridRect.top + gridRect.height / 2;

      cards.forEach(card => {
        const rect = card.getBoundingClientRect();
        const offsetX = centerX - (rect.left + rect.width / 2);
        const offsetY = centerY - (rect.top + rect.height / 2);
        card.style.transition = 'transform 0.5s ease-in-out';
        card.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
      });

      setTimeout(() => {
        createBoard(true);
        boardLocked = false;
        if (gameStarted) {
          startMoveTimer();
          startGameTimer();
        }

        const newCards = Array.from(document.querySelectorAll('.card'));
        const newGridRect = gameGrid.getBoundingClientRect();
        const centerX = newGridRect.left + newGridRect.width / 2;
        const centerY = newGridRect.top + newGridRect.height / 2;

        newCards.forEach(card => {
          const rect = card.getBoundingClientRect();
          const offsetX = centerX - (rect.left + rect.width / 2);
          const offsetY = centerY - (rect.top + rect.height / 2);
          card.style.transition = 'none';
          card.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
        });

        setTimeout(() => {
          newCards.forEach(card => {
            card.style.transition = 'transform 0.6s ease-in-out';
            card.style.transform = 'translate(0, 0)';
          });

          setTimeout(() => {
            newCards.forEach(card => {
              card.style.transition = '';
              card.style.transform = '';
            });

            const labelCells = document.querySelectorAll('.label-cell');
            requestAnimationFrame(() => {
              labelCells.forEach(el => el.classList.remove('hide-label'));
            });
          }, 600);
        }, 30);
      }, 600);
    }

    function showConfigScreen() {
      configScreenContainer.style.display = 'block';
      gameScreenContainer.style.display = 'none';
      team1NameInput.value = '';
      team2NameInput.value = '';
      btnTeam1.classList.remove('active');
      btnTeam2.classList.remove('active');
      moveTimeButtons.querySelectorAll('button').forEach(btn => btn.classList.remove('active'));
      timeButtons.querySelectorAll('button').forEach(btn => btn.classList.remove('active'));
      startingTeam = null;
      moveTimeLimit = null;
      gameTimeLimit = null;
      updateButtonLabels();
    }

    function showGameScreen() {
      configScreenContainer.style.display = 'none';
      gameScreenContainer.style.display = 'flex';

      team1Name = team1NameInput.value.trim() || 'Team 1';
      team2Name = team2NameInput.value.trim() || 'Team 2';
      moveTimeLimit = moveTimeLimit || 0;
      gameTimeLimit = gameTimeLimit || 0;

      if (isNaN(moveTimeLimit) || moveTimeLimit < 0) {
        console.error('Invalid move time:', moveTimeLimit);
        moveTimeLimit = 0;
      }
      if (isNaN(gameTimeLimit) || gameTimeLimit < 0) {
        console.error('Invalid game time:', gameTimeLimit);
        gameTimeLimit = 0;
      }

      team1NameDisplay.textContent = team1Name;
      team2NameDisplay.textContent = team2Name;
      moveTimeDisplay.textContent = moveTimeLimit === 0 ? 'Unlimited' : formatTime(moveTimeLimit);
      gameTimeDisplay.textContent = gameTimeLimit === 0 ? 'Unlimited' : formatTime(gameTimeLimit * 60);
      moveSecondsCount = moveTimeLimit;
      gameSecondsCount = gameTimeLimit * 60;
      currentTeam = null;

      createBoard(false);
      updateTeamHighlight();
      updateCurrentTeamDisplay();
      const labelCells = document.querySelectorAll('.label-cell');
      requestAnimationFrame(() => {
        labelCells.forEach(el => el.classList.remove('hide-label'));
      });
    }

    nextBtnBtn.addEventListener('click', () => {
      showGameScreen();
    });

    startGameBtn.addEventListener('click', () => {
      if (!gameStarted) {
        currentTeam = startingTeam === null ? true : startingTeam;
        document.querySelectorAll('.cover').forEach(cover => cover.classList.add('kolorowa'));
        boardLocked = false;
        if (moveTimeLimit > 0) {
          moveSecondsCount = moveTimeLimit;
          moveTimeDisplay.textContent = formatTime(moveSecondsCount);
          startMoveTimer();
        } else {
          moveTimeDisplay.textContent = 'Unlimited';
        }
        if (gameTimeLimit > 0) {
          gameSecondsCount = gameTimeLimit * 60;
          gameTimeDisplay.textContent = formatTime(gameSecondsCount);
          startGameTimer();
        } else {
          gameTimeDisplay.textContent = 'Unlimited';
        }
        startGameBtn.textContent = 'Restart';
        gameStarted = true;
        updateTeamHighlight();
        updateCurrentTeamDisplay();
      } else {
        restartAndStart();
      }
    });

    function toggleFullscreen() {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
      } else {
        document.exitFullscreen();
      }
    }

    configFullscreenBtn.addEventListener('click', toggleFullscreen);
    gameFullscreenBtn.addEventListener('click', toggleFullscreen);

    document.addEventListener('fullscreenchange', () => {
      if (document.fullscreenElement) {
        configFullscreenBtn.textContent = 'Exit Fullscreen';
        gameFullscreenBtn.textContent = 'Exit Fullscreen';
        document.body.classList.add('fullscreen-active');
      } else {
        configFullscreenBtn.textContent = 'Fullscreen';
        gameFullscreenBtn.textContent = 'Fullscreen';
        document.body.classList.remove('fullscreen-active');
      }
    });

    backBtn.addEventListener('click', () => {
      clearInterval(moveTimerInterval);
      clearInterval(gameTimerInterval);
      gameStarted = false;
      startGameBtn.textContent = 'Start';
      showConfigScreen();
    });

    updateButtonLabels();
    configScreenContainer.style.display = 'block';
    gameScreenContainer.style.display = 'none';
  </script>
</body>
</html>
